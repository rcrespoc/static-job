const d=document,itemsFilter=d.querySelector(".items"),jobsItems=d.querySelector(".jobs"),divCleose=d.querySelector(".close");let objFiltrado=[];async function cargarDOM(){dibujarHTML(await cargarTrabajos())}async function cargarTrabajos(){try{const e=await fetch("./data.json");return await e.json()}catch(e){console.log(e)}}function dibujarHTML(e){limpiarHTML();const t=d.createDocumentFragment();e.forEach(e=>{const{company:a,logo:r,featured:o,new:n,position:i,postedAt:l,role:s,level:c,location:m,contract:u,languages:f}=e,h=d.createElement("div");if(h.classList.add("job-item"),h.innerHTML=`\n    <header class="job-header">\n      <div class="titles-job">\n        <h6>${a}</h6>\n      </div> \x3c!-- TITULO --\x3e\n      <img src="${r}" alt="${a}">\n    </header> \x3c!-- HEADER JOB --\x3e\n    <section class="job-body">\n      <header>\n        <h6>${i}</h6>\n        <small>${l}</small>\n        <small>${u}</small>\n        <small>${m}</small>\n        <hr>\n      </header>\n      <div class="features">\n      <a href="#" class="feature-item">${s}</a>\n      <a href="#" class="feature-item">${c}</a>\n      </div> \x3c!-- FEATURES --\x3e\n    </section> \x3c!-- JOB BODY --\x3e`,n){const e=d.createElement("span");e.classList.add("new"),e.textContent="NEW!",h.querySelector(".titles-job").appendChild(e)}if(o){const e=d.createElement("span");e.classList.add("feature"),e.textContent="FEATURED",h.querySelector(".titles-job").appendChild(e)}f.forEach(e=>{const t=d.createElement("a");t.href="#",t.classList.add("feature-item"),t.textContent=e,h.querySelector(".features").appendChild(t)}),h.querySelectorAll(".feature-item").forEach(e=>{e.addEventListener("click",e=>{objFiltrado.includes(e.target.textContent)||objFiltrado.push(e.target.textContent),filtrarObjetos(objFiltrado)})}),t.appendChild(h)}),jobsItems.appendChild(t)}function filtrarObjetos(e){limpiarFiltro();const t=d.createDocumentFragment();d.querySelector(".filters").classList.remove("none"),e.forEach(e=>{const a=d.createElement("section");a.classList.add("filter-item"),a.innerHTML=`\n      <h6>${e}</h6>\n      <div class="icon">\n        <img src="images/icon-remove.svg" alt="Icon Remove">\n      </div>\n    `,a.querySelector(".icon").addEventListener("click",t=>{consultarJobs(objFiltrado=objFiltrado.filter(t=>t!==e)),itemsFilter.removeChild(a),1===itemsFilter.childElementCount&&(d.querySelector(".filters").classList.add("none"),cargarDOM())}),t.appendChild(a)}),itemsFilter.appendChild(t),consultarJobs(objFiltrado)}function limpiarFiltro(){itemsFilter.querySelectorAll(".filter-item").forEach(e=>{itemsFilter.removeChild(e)}),d.querySelector(".filters").classList.add("none")}function limpiarObjeto(){for(;objFiltrado.length>0;)objFiltrado.pop()}async function consultarJobs(e){const t=await cargarTrabajos(),a=[];t.forEach(t=>{const{languages:r,role:o,level:n}=t;e.forEach(e=>{(r.includes(e)||o===e||n===e)&&(a.includes(t)||a.push(t))})}),dibujarHTML(a)}function limpiarHTML(){for(;jobsItems.firstElementChild;)jobsItems.removeChild(jobsItems.firstElementChild)}d.addEventListener("DOMContentLoaded",cargarDOM),divClose.addEventListener("click",e=>{limpiarFiltro(),limpiarObjeto(),cargarDOM()});